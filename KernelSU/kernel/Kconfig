menu "KernelSU"

config KSU
    tristate "KernelSU function support"
    default y
    help
      Enable kernel-level root privileges on Android System.
      To compile as a module, choose M here: the
      module will be called kernelsu.

config KSU_DEBUG
    bool "KernelSU debug mode"
    depends on KSU
    default n
    help
      Enable KernelSU debug mode.

config KSU_MANUAL_SU
    bool "Use manual su"
    depends on KSU
    default y
    help
      Use manual su and authorize the corresponding command line and application via prctl

config KPM
    bool "Enable SukiSU KPM"
    depends on KSU && 64BIT
    default n
    help
      Enabling this option will activate the KPM feature of SukiSU.
      This option is suitable for scenarios where you need to force KPM to be enabled.
      but it may affect system stability.
    select KALLSYMS
    select KALLSYMS_ALL

menu "KernelSU - SUSFS"

config KSU_SUSFS
    bool "KernelSU addon - SUSFS"
    depends on KSU
    depends on THREAD_INFO_IN_TASK
    default y
    help
      Patch and enable SUSFS to the kernel with KernelSU.

config KSU_SUSFS_SUS_PATH
    bool "Hide suspicious path (not recommended)"
    depends on KSU_SUSFS
    default y
    help
      Hide user-defined paths from various system calls.

config KSU_SUSFS_SUS_MOUNT
    bool "Hide suspicious mounts"
    depends on KSU_SUSFS
    default y
    help
      Hide user-defined mount paths from /proc/* mount interfaces.

config KSU_SUSFS_SUS_KSTAT
    bool "Spoof suspicious kstat"
    depends on KSU_SUSFS
    default y
    help
      Spoof kstat for user-defined files/directories.

config KSU_SUSFS_SPOOF_UNAME
    bool "Spoof uname"
    depends on KSU_SUSFS
    default y
    help
      Spoof the strings returned by uname() to user-defined strings.

config KSU_SUSFS_ENABLE_LOG
    bool "Enable susfs kernel logging"
    depends on KSU_SUSFS
    default y
    help
      Enable susfs logging in kernel.

config KSU_SUSFS_HIDE_KSU_SUSFS_SYMBOLS
    bool "Hide ksu/susfs symbols from /proc/kallsyms"
    depends on KSU_SUSFS
    default y
    help
      Automatically hide ksu and susfs symbols from /proc/kallsyms.

config KSU_SUSFS_SPOOF_CMDLINE_OR_BOOTCONFIG
    bool "Spoof /proc/bootconfig (GKI) or /proc/cmdline (non-GKI)"
    depends on KSU_SUSFS
    default y
    help
      Spoof /proc/bootconfig or /proc/cmdline output with a user-defined file.

config KSU_SUSFS_OPEN_REDIRECT
    bool "Redirect opened paths (experimental)"
    depends on KSU_SUSFS
    default y
    help
      Redirect a target path to another user-defined path when opening.

config KSU_SUSFS_SUS_MAP
    bool "Hide suspicious mmap file mappings"
    depends on KSU_SUSFS
    default y
    help
      Hide some file-backed mmaps from proc map interfaces.

endmenu

endmenu
